import{d as H,r as F,a as y,c as L,b as d,w as m,E as _e,o as v,e as E,p as z,f as B,g as r,h as pe,i as oe,j as me,k as X,t as k,u as I,l as V,m as $,n as se,F as P,q as fe,s as ve,v as ge,x as he,y as ye,z as we,A as ne,B as Se,C as be,D as le,G as ae,H as K,I as Le,J as Ie,K as ke,L as xe}from"./vendor-fdc8bbe2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const Z=e=>{const t=navigator.userAgent,s=/Chrome/.test(t)&&/Google Inc/.test(navigator.vendor),i=/Firefox/.test(t),o=/Trident/.test(t),n=/Edge/.test(t),l=/Safari/.test(t)&&/Apple Computer/.test(navigator.vendor),u=s*5+i*10+o*10+n*10+l*5||5;let a=1024*1024*u*.9;return new Blob([e]).size>a},Ee=(e,t,s)=>{localStorage.setItem("token",e),localStorage.setItem("saveTokenTime",JSON.stringify(t)),localStorage.setItem("expiresIn",JSON.stringify(s))};let M;const Q=()=>{const e="chatsList";return M=localStorage.getItem(e),M===null?[]:JSON.parse(M)},Te=()=>{if(!localStorage.getItem("token"))return!0;const e=JSON.parse(localStorage.getItem("saveTokenTime")),t=JSON.parse(localStorage.getItem("expiresIn"));return new Date().getTime()/1e3-e>t},Ce=(e,t)=>{let s,i;e.addEventListener("touchstart",function(o){s=o.touches[0].clientX,i=o.touches[0].clientY}),e.addEventListener("touchmove",function(o){const n=o.touches[0].clientX-s,l=o.touches[0].clientY-i;Math.abs(n)>Math.abs(l)?n<-80?(console.log("向左滑动"),t()):console.log("向右滑动"):l<0?console.log("向上滑动"):console.log("向下滑动")}),e.addEventListener("touchend",function(o){s=null,i=null})};function qe(){const e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipod","ipad","windows phone","blackberry","mobile"];for(let s=0;s<t.length;s++)if(e.indexOf(t[s])!==-1)return!0;return!1}const Ve=(e,t)=>{e.addEventListener("contextmenu",function(s){console.log("🚀 ~ file: utils.js:165 ~ event:",s.target),console.log(window.getSelection().toString()),t()})},ie=e=>(z("data-v-5ee62532"),e=e(),B(),e),$e={class:"login-box"},Ne=ie(()=>r("div",{class:"login-title"}," ai chat登录 ",-1)),Ae=ie(()=>r("div",{class:"login-footer"},null,-1)),Oe=H({__name:"Login",emits:["loginSuccess"],setup(e,{emit:t}){const s=F({username:"",password:""}),i=y(),o=F({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),n=async u=>{u&&await u.validate((a,h)=>{if(a&&s.username==="huhaibiao")return l({success:!0,data:{token:1,expiresIn:2e5}})})},l=u=>{let a="登录成功",h,S;u.success?(a="登录成功",h="success",S=1e3,Ee(u.data.token,new Date().getTime()/1e3,u.data.expiresIn),t("loginSuccess")):(a=u.msg,h="error",S=3e3),pe({message:a,type:h,duration:S})};return(u,a)=>{const h=oe,S=me,q=X,g=_e;return v(),L("div",$e,[Ne,d(g,{ref_key:"ruleFormRef",ref:i,model:s,rules:o,style:{width:"100%"}},{default:m(()=>[d(S,{prop:"username"},{default:m(()=>[d(h,{modelValue:s.username,"onUpdate:modelValue":a[0]||(a[0]=T=>s.username=T),placeholder:"用户名",class:"div-box"},null,8,["modelValue"])]),_:1}),d(S,{prop:"password"},{default:m(()=>[d(h,{modelValue:s.password,"onUpdate:modelValue":a[1]||(a[1]=T=>s.password=T),type:"password",placeholder:"密码","show-password":"",class:"div-box"},null,8,["modelValue"])]),_:1}),d(q,{type:"primary",class:"div-box",onClick:a[2]||(a[2]=T=>n(i.value))},{default:m(()=>[E("登录")]),_:1})]),_:1},8,["model","rules"]),Ae])}}});const N=(e,t)=>{const s=e.__vccOpts||e;for(const[i,o]of t)s[i]=o;return s},De=N(Oe,[["__scopeId","data-v-5ee62532"]]),He=y(0);const Je=e=>(z("data-v-cc953e34"),e=e(),B(),e),Re={key:0,class:"development"},Ue=Je(()=>r("div",null,"开发环境",-1)),Fe={__name:"Developer",setup(e){const t=y("production");return(s,i)=>t.value==="development"?(v(),L("div",Re,[Ue,r("div",null,"ws连接状态："+k(),1),r("div",null,"正在请求中数："+k(I(He)),1)])):V("",!0)}},Pe=N(Fe,[["__scopeId","data-v-cc953e34"]]),ze=H({__name:"DownLoadChatsList",setup(e){function t(i,o){const n=document.createElement("a"),l=new Blob([o]),u=URL.createObjectURL(l);n.href=u,n.download=i+".json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(u)}const s=i=>{const o=Q();t("ai-chat-history",JSON.stringify(o))};return(i,o)=>{const n=X;return v(),$(n,{type:"primary",plain:"",onClick:s},{default:m(()=>[E("导出所有对话")]),_:1})}}}),Be={key:1},je=H({__name:"QuestList",emits:["change"],setup(e,{emit:t}){const s=y(Q()),i=y(),o=u=>{t("change",u,s.value[u])},n=qe(),l=y(n);return(u,a)=>{const h=ve,S=ge,q=fe;return v(),$(q,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=g=>i.value=g),placeholder:"打开问题列表",filterable:"",onChange:o,style:{height:"800px"}},{default:m(()=>[(v(!0),L(P,null,se(s.value,(g,T)=>(v(),$(S,{class:"option",key:T,label:g.question,value:T},{default:m(()=>[l.value?(v(),L("div",Be,k(g.question),1)):(v(),$(h,{key:0,class:"box-item",effect:"dark",content:g.question,"hide-after":0,placement:"top"},{default:m(()=>[E(k(g.question),1)]),_:2},1032,["content"]))]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])}}});const Me=N(je,[["__scopeId","data-v-04451b97"]]),We={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Xe=r("path",{fill:"currentColor",d:"M926.784 480H701.312A192.512 192.512 0 0 0 544 322.688V97.216A416.064 416.064 0 0 1 926.784 480zm0 64A416.064 416.064 0 0 1 544 926.784V701.312A192.512 192.512 0 0 0 701.312 544h225.472zM97.28 544h225.472A192.512 192.512 0 0 0 480 701.312v225.472A416.064 416.064 0 0 1 97.216 544zm0-64A416.064 416.064 0 0 1 480 97.216v225.472A192.512 192.512 0 0 0 322.688 480H97.216z"},null,-1),Qe=[Xe];function Ye(e,t){return v(),L("svg",We,Qe)}const Ge={name:"ep-HelpFilled",render:Ye};const Ke={},Y=e=>(z("data-v-943f389e"),e=e(),B(),e),Ze={class:"loading"},et=Y(()=>r("div",{class:"point an-point"},null,-1)),tt=Y(()=>r("div",{class:"point an-point"},null,-1)),ot=Y(()=>r("div",{class:"point an-point"},null,-1)),st=[et,tt,ot];function nt(e,t){return v(),L("div",Ze,st)}const ee=N(Ke,[["render",nt],["__scopeId","data-v-943f389e"]]);let W="ws://18.216.251.165:8088";location!=null&&location.protocol.includes("https")&&(W="wss"+W.slice(2));const D={appId:"G8CPjjcTqnNU4NjC",sessionId:"qbd4r6rahnxuazy5qoqd"},C={mesHandle(e){},closeHandle(e){},openHandle(e){console.log("time:"+new Date().toLocaleTimeString()+"🚀 ~ file: websocketChat.js:20 ~ openHandle ~ event:",e)},errorHandle(e){}};let b={};const re=()=>{let e=`${W}?appId=${D.appId}&sessionId=${D.sessionId}`;const t=localStorage.getItem("token");t&&(e=e+`&token=${t}`),b=new WebSocket(e),b.onclose=C.closeHandle,b.onerror=C.errorHandle,b.onmessage=C.mesHandle,b.onopen=C.openHandle};function lt(){}setInterval(lt,1e4);const te=(e="")=>{const t=setInterval(()=>{b.readyState===WebSocket.OPEN&&(clearInterval(t),b.send(e))},200)},at=(e="")=>{if(b.readyState===WebSocket.OPEN)return b.send(e);if(b.readyState!==WebSocket.OPEN){if(b.readyState===WebSocket.CONNECTING)return te(e),console.warn("正在连接中");re()}te(e)};const ce=e=>(z("data-v-f94e1af3"),e=e(),B(),e),it={class:"chat-list"},rt={class:"chat-item chat-item-user",style:{position:"relative"}},ct={class:"chat-item-rep mr-10 user"},dt=ce(()=>r("div",{class:"me square"},"我",-1)),ut={class:"time",style:{position:"absolute",bottom:"-25px",right:"50px"}},_t={class:"chat-item",style:{position:"relative"}},pt=ce(()=>r("div",{class:"square"},"ai",-1)),mt={class:"chat-item-rep ml-10"},ft={class:"time",style:{position:"absolute",bottom:"-25px",left:"50px"}},vt={class:"submit-bottom"},gt={style:{"word-wrap":"break-word"}},ht={class:"dialog-footer"},yt=H({__name:"WsChat",emits:["JLogin"],setup(e,{emit:t}){t("JLogin");let s=-1;const i=localStorage.getItem("sessionId");i?D.sessionId=i:(D.sessionId=he(),localStorage.setItem("sessionId",D.sessionId));const o=y("");let n=y(0),l=F([]);l.push(...Q()),s=l.length-1;const u=y(null),a=y(null);let h=!0;const S=_=>{let p=o.value;_?p=_:s=l.length;const w=F({question:"",questionTime:"",rep:"",repTime:""});if(o.value="",w.question=p,w.questionTime=new Date().toLocaleString(),o.value="",!p.trim())return;n.value=1,l.splice(s,0,w),h=!0;const x=JSON.stringify({req:p,index:s});at(x),s===l.length-1&&setTimeout(()=>{document.querySelector(".chat-item-scrollTo").scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})})};ye(()=>{}),we(()=>{b.close()}),ne(()=>{var R,U;u.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"});var _=document.querySelectorAll(".submit-bottom");let p=0;document.querySelector(".chat-list").addEventListener("scroll",function(f){f.target.scrollTop<p&&(h=!1),p=f.target.scrollTop,w(f.target)&&f.preventDefault()});function w(f){for(var c=0;c<_.length;c++)if(_[c].contains(f))return!0;return!1}document.addEventListener("touchmove",function(f){if(!w(f.target)){var c=document.activeElement;(c.tagName==="INPUT"||c.tagName==="TEXTAREA")&&c.blur()}});let x=!1;const O=document.querySelector(".chat-input");O.addEventListener("compositionstart",()=>{x=!0}),O.addEventListener("compositionend",f=>{x=!1}),O.addEventListener("keydown",f=>{f.key==="Enter"&&!x&&(f.preventDefault(),S())}),(R=document.querySelector(".chat-list"))==null||R.addEventListener("mousedown",f=>{var c;s=+((c=f.target)==null?void 0:c.getAttribute("class"))}),Ve(document.querySelector(".chat-list"),G),(U=document.querySelector(".chat-list"))==null||U.addEventListener("contextmenu",function(f){var c;s=+((c=f.target)==null?void 0:c.getAttribute("class")),f.preventDefault(),G()})});const q=()=>{b.close(),n.value=0},g=(_=[])=>{const p=JSON.stringify(_);if(Z(p))_.shift(),_.shift(),Z(JSON.stringify(_))&&g(_);else return},T=(_=[])=>{g(_);const p="chatsList";try{localStorage.setItem(p,JSON.stringify(_))}catch(w){console.error("本地存储数据时出错：",w)}},de=(_={content:"",id:0})=>{n.value=2,l[_.id].rep+=_.content,h&&setTimeout(()=>{u.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})})};C.mesHandle=_=>{let p=_.data,w=JSON.parse(p);w.msg==="DONE"&&(n.value=0,l[s].repTime=new Date().toLocaleString(),T(l)),w.time||de(w)},C.closeHandle=_=>{console.log("WebSocket closed with code "+_.code+" and reason "+_.reason+"time:"+new Date().toLocaleTimeString()),n.value=0,alert("ws链接关闭")},C.errorHandle=()=>{n.value=0},C.openHandle=()=>{n.value=0};const A=y(!1),G=()=>{J.value=window.getSelection().toString(),J.value&&(A.value=!0)},J=y(""),ue=()=>{S(J.value),A.value=!1};return re(),(_,p)=>{const w=Le,x=X,O=oe,R=ee,U=le,f=ae;return v(),L(P,null,[r("div",it,[(v(!0),L(P,null,se(I(l),(c,j)=>(v(),L("div",{key:j},[r("div",rt,[r("div",ct,k(c.question),1),dt,r("div",ut,[d(w,{type:"info",size:"small"},{default:m(()=>[E(k("时间:"+c.questionTime),1)]),_:2},1024)])]),r("div",_t,[pt,r("div",mt,[c.rep?V("",!0):(v(),$(ee,{key:0})),r("span",{class:K(j+1+"")},[E(k(c.rep),1),r("span",{class:K({"rep-light-cursor":j===I(l).length-1&&I(n)===2})},null,2)],2)]),r("div",ft,[d(w,{type:"info",size:"small"},{default:m(()=>[E(k("时间:"+c.repTime),1)]),_:2},1024)])])]))),128)),r("div",{class:"chat-item-scrollTo",ref_key:"scrollToDom",ref:u},null,512)]),r("div",vt,[Se(d(x,{type:"danger",round:"",class:"doneRep",onClick:q},{default:m(()=>[E("终止回答")]),_:1},512),[[be,I(n)!==0]]),d(O,{ref_key:"qInoutEl",ref:a,class:"do-scrollbar-b chat-input",modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=c=>o.value=c),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"欢迎提问～"},null,8,["modelValue"]),d(x,{type:"primary",class:"ml-10 submit-btn",onClick:S,disabled:I(n)!==0},{default:m(()=>[E(k(I(n)!==0?"回复中":"提交"),1),I(n)!==0?(v(),$(U,{key:0,class:"is-loading"},{default:m(()=>[d(R)]),_:1})):V("",!0)]),_:1},8,["disabled"])]),d(f,{modelValue:A.value,"onUpdate:modelValue":p[2]||(p[2]=c=>A.value=c),width:"70%",center:""},{footer:m(()=>[r("span",ht,[d(x,{onClick:p[1]||(p[1]=c=>A.value=!1)},{default:m(()=>[E("取消")]),_:1}),d(x,{type:"primary",onClick:ue},{default:m(()=>[E(" 提交 ")]),_:1})])]),default:m(()=>[r("div",gt,k(J.value),1)]),_:1},8,["modelValue"])],64)}}});const wt=N(yt,[["__scopeId","data-v-f94e1af3"]]),St={key:0,class:"exp-chat-list"},bt={style:{"white-space":"pre-wrap"}},Lt={key:1,style:{width:"100%",height:"100%"},class:"chat-component"},It={key:2,class:"login"},kt=H({__name:"App",setup(e){let t=y(!0);const s=()=>{t.value=Te()};s();const i=y({question:"",rep:""}),o=y(!1),n=(u,a)=>{i.value=a,o.value=!0},l=y(!1);return ne(()=>{Ce(document,()=>l.value=!0)}),(u,a)=>{const h=le,S=ke,q=ae;return v(),L(P,null,[I(t)?V("",!0):(v(),L("div",St,[d(h,{size:30,style:{"margin-top":"10px",cursor:"pointer"},color:"#409EFC",onClick:a[0]||(a[0]=g=>l.value=!l.value)},{default:m(()=>[d(I(Ge))]),_:1}),d(S,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=g=>l.value=g),title:"I am the title","with-header":!1,size:"220"},{default:m(()=>[d(ze),d(Me,{style:{"margin-top":"10px"},onChange:n})]),_:1},8,["modelValue"])])),d(q,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=g=>o.value=g),title:i.value.question,width:"80%"},{default:m(()=>[r("div",bt,k(i.value.rep),1)]),_:1},8,["modelValue","title"]),d(Pe),I(t)?V("",!0):(v(),L("div",Lt,[d(wt,{onJLogin:s})])),I(t)?(v(),L("div",It,[d(De,{onLoginSuccess:a[3]||(a[3]=g=>Ie(t)?t.value=!1:t=!1)})])):V("",!0)],64)}}});const xt=N(kt,[["__scopeId","data-v-3e30f885"]]);const Et=xe(xt);Et.mount("#app");window.hhh_API_key="hhsk-sXorgfTEXsSjL3dYRyz5T3BlbkFJLPSgoEzrTM9QxZZOvhMAhh";window.__APP_ENV__="production";console.log(window.__APP_ENV__,!1);
