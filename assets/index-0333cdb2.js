import{o as _,c as w,p as z,a as B,b as u,r as y,d as re,e as J,v as ue,f as j,g as de,h as pe,i as Z,w as _e,F as R,j as W,k as me,l as fe,u as A,m as d,n as p,q as k,t as x,E as ee,s as Y,x as te,y as oe,z as $,A as O,B as G,C as he,D as ge,G as ve,H as ye,I as we,J as Se,K as be,L as Le,M as xe,N as Ie}from"./vendor-db3e7544.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();const V=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},Ce={},Q=e=>(z("data-v-943f389e"),e=e(),B(),e),ke={class:"loading"},Ee=Q(()=>u("div",{class:"point an-point"},null,-1)),Ae=Q(()=>u("div",{class:"point an-point"},null,-1)),qe=Q(()=>u("div",{class:"point an-point"},null,-1)),Te=[Ee,Ae,qe];function Ve(e,t){return _(),w("div",ke,Te)}const $e=V(Ce,[["render",Ve],["__scopeId","data-v-943f389e"]]);let P="";P="ws://localhost:8088/";location!=null&&location.protocol.includes("https")&&(P="wss"+P.slice(2));const F={appId:"G8CPjjcTqnNU4NjC",sessionId:"qbd4r6rahnxuazy5qoqd"};function Oe(){}setInterval(Oe,1e4);const K=e=>{const t=navigator.userAgent,s=/Chrome/.test(t)&&/Google Inc/.test(navigator.vendor),n=/Firefox/.test(t),o=/Trident/.test(t),l=/Edge/.test(t),a=/Safari/.test(t)&&/Apple Computer/.test(navigator.vendor),c=s*5+n*10+o*10+l*10+a*5||5;let i=1024*1024*c*.9;return new Blob([e]).size>i},Ne=(e,t,s)=>{localStorage.setItem("token",e),localStorage.setItem("saveTokenTime",JSON.stringify(t)),localStorage.setItem("expiresIn",JSON.stringify(s))};let M;const U=()=>{const e="chatsList";return M=localStorage.getItem(e),M===null?[]:JSON.parse(M)},se=(e=[],t="chat-list")=>{ne(e);try{localStorage.setItem(t,JSON.stringify(e))}catch(s){console.error("本地存储数据时出错：",s)}},ne=(e=[])=>{const t=JSON.stringify(e);if(K(t))e.shift(),e.shift(),K(JSON.stringify(e))&&ne(e);else return},De=()=>{if(!localStorage.getItem("token"))return!0;const e=JSON.parse(localStorage.getItem("saveTokenTime")),t=JSON.parse(localStorage.getItem("expiresIn"));return new Date().getTime()/1e3-e>t},Je=(e,t)=>{let s,n;e.addEventListener("touchstart",function(o){s=o.touches[0].clientX,n=o.touches[0].clientY}),e.addEventListener("touchmove",function(o){const l=o.touches[0].clientX-s,a=o.touches[0].clientY-n;Math.abs(l)>Math.abs(a)?l<-80?(console.log("向左滑动"),t()):console.log("向右滑动"):a<0?console.log("向上滑动"):console.log("向下滑动")}),e.addEventListener("touchend",function(o){s=null,n=null})};function je(){const e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipod","ipad","windows phone","blackberry","mobile"];for(let s=0;s<t.length;s++)if(e.indexOf(t[s])!==-1)return!0;return!1}const Re=(e,t)=>{e.addEventListener("contextmenu",function(s){console.log("🚀 ~ file: utils.js:165 ~ event:",s.target),console.log(window.getSelection().toString()),t()})},N=y(0),ze=e=>(N.value++,e.finally(t=>{N.value--})),D=U(),X=D.findIndex(e=>e==null);console.log("🚀 ~ file: websocketChat.js:20 ~ x ~ x:",X,D.length);X>0&&(D.splice(X-1,2),se(D));let H=[{role:"system",content:"You are a professional front end assistant."}];D.forEach((e,t)=>{H=[...H,{role:"user",content:e.question},{role:"assistant",content:e.rep}]});const le=[],Be=e=>{console.log("🚀 ~ file: index.js:26 ~ postOpenAi ~ request:",e,"time:"+new Date().toLocaleTimeString());let t=JSON.parse(JSON.stringify(H));le.forEach((n,o)=>{t=[...t,{role:"user",content:n.question},{role:"assistant",content:n.rep}]}),t.push({role:"user",content:e});const s=t.length;return s>=7&&t.splice(1,s-4),re.post("https://api.openai.com/v1/chat/completions",{model:"gpt-3.5-turbo-0301",messages:t,temperature:.6,n:1,user:"user"},{headers:{Authorization:`Bearer ${window.hhh_API_key.slice(0,-2)}`,"Content-Type":"application/json"},withCredentials:!1}).then(n=>{var a,c;let o=n.data;typeof o=="string"&&(o=JSON.parse(n.data)),console.log("🚀 ~ file: websocketChat.js:38 ~ postOpenAi ~ response:",typeof o,o);const l=(c=(a=o.choices[0])==null?void 0:a.message)==null?void 0:c.content;return t.push({role:"assistant",content:l}),l}).catch(n=>{const o=n==null?void 0:n.message;throw console.log("🚀 ~ file: index.js:75 ~ postOpenAi ~ er:",n),console.log("post api请求出错"),new Error(o)})},ae=e=>(z("data-v-40cc8099"),e=e(),B(),e),Ue={class:"chat-list"},Fe={class:"chat-item chat-item-user",style:{position:"relative"}},Me={class:"chat-item-rep mr-10 user"},Pe=ae(()=>u("div",{class:"me square"},"我",-1)),Xe={class:"time",style:{position:"absolute",bottom:"-25px",right:"50px"}},He={class:"chat-item",style:{position:"relative"}},Ye=ae(()=>u("div",{class:"square"},"ai",-1)),Qe={class:"chat-item-rep ml-10"},Ge={class:"time",style:{position:"absolute",bottom:"-25px",left:"50px"}},Ke={class:"submit-bottom"},Ze={style:{"word-wrap":"break-word"}},We={class:"dialog-footer"},et=J({__name:"ChatComponent",emits:["JLogin"],setup(e,{emit:t}){t("JLogin");let s=-1;const n=localStorage.getItem("sessionId");n?F.sessionId=n:(F.sessionId=ue(),localStorage.setItem("sessionId",F.sessionId));const o=y("");let l=y(0);const a=j([]),c=y(null),i=y(null),g=E=>{let S=o.value;E&&(S=E);const h=j({question:"",questionTime:"",rep:"",repTime:""});if(h.question=S,h.questionTime=new Date().toLocaleString(),o.value="",!S.trim())return;l.value=1,s!==-1?(a.splice(s+1,0,h),s=-1):a.push(h);const I=Be(h.question);ze(I).then(C=>{console.log("🚀 ~ file: ChatComponent.vue:42 ~ postOpenAi ~ res:",C),h.rep=C,h.repTime=new Date().toLocaleString(),le.push(h),console.log("🚀 ~ file: ChatComponent.vue:59 ~ useActionRequest ~ chatItem:",JSON.stringify(h)),l.value=0,ee({message:"",type:"success"}),se(a,"chatsList")}).catch(C=>{var T,v,r;h.rep=(r=(v=(T=C.response)==null?void 0:T.data)==null?void 0:v.error)==null?void 0:r.message,h.repTime=new Date().toLocaleString()})};de(()=>{a.push(...U()),console.log("🚀 ~ file: ChatComponent.vue:76 ~ onBeforeMount ~ chatsList:",a)}),pe(()=>{}),Z(()=>{var T,v;c.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"});var E=document.querySelectorAll(".submit-bottom");let S=0;document.querySelector(".chat-list").addEventListener("scroll",function(r){r.target.scrollTop<S,S=r.target.scrollTop,h(r.target)&&r.preventDefault()});function h(r){for(var b=0;b<E.length;b++)if(E[b].contains(r))return!0;return!1}document.addEventListener("touchmove",function(r){if(!h(r.target)){var b=document.activeElement;(b.tagName==="INPUT"||b.tagName==="TEXTAREA")&&b.blur()}});let I=!1;const C=document.querySelector(".chat-input");C.addEventListener("compositionstart",()=>{I=!0}),C.addEventListener("compositionend",r=>{I=!1}),C.addEventListener("keydown",r=>{r.key==="Enter"&&!I&&(r.preventDefault(),g())}),(T=document.querySelector(".chat-list"))==null||T.addEventListener("mousedown",r=>{var b;s=+((b=r.target)==null?void 0:b.getAttribute("class"))}),Re(document.querySelector(".chat-list"),f),(v=document.querySelector(".chat-list"))==null||v.addEventListener("contextmenu",function(r){var b;s=+((b=r.target)==null?void 0:b.getAttribute("class")),f()})});const m=y(!1);_e(m,E=>{E===!1&&(s=-1)});const q=()=>{l.value=0},f=()=>{L.value=window.getSelection().toString(),L.value&&(m.value=!0)},L=y(""),ce=()=>{g(L.value),m.value=!1};return(E,S)=>{const h=he,I=Y,C=te,T=oe;return _(),w(R,null,[u("div",Ue,[(_(!0),w(R,null,W(a,(v,r)=>(_(),w("div",{key:r},[u("div",Fe,[u("div",Me,x(v.question),1),Pe,u("div",Xe,[d(h,{type:"info",size:"small"},{default:p(()=>[k(x("时间:"+v.questionTime),1)]),_:2},1024)])]),u("div",He,[Ye,u("div",Qe,[v.rep?O("",!0):(_(),$($e,{key:0})),(_(),w("span",{class:G(r+""),key:r},[k(x(v.rep),1),u("span",{class:G({"rep-light-cursor":r===a.length-1&&A(l)===2})},null,2)],2))]),u("div",Ge,[d(h,{type:"info",size:"small"},{default:p(()=>[k(x("时间:"+v.repTime),1)]),_:2},1024)])])]))),128)),u("div",{class:"chat-item-scrollTo",ref_key:"scrollToDom",ref:c},null,512)]),u("div",Ke,[me(d(I,{type:"danger",round:"",class:"doneRep",onClick:q},{default:p(()=>[k("正在请求中数："+x(A(N))+",终止所有请求",1)]),_:1},512),[[fe,A(N)!==0]]),d(C,{ref_key:"qInoutEl",ref:i,class:"do-scrollbar-b chat-input",modelValue:o.value,"onUpdate:modelValue":S[0]||(S[0]=v=>o.value=v),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"欢迎提问～"},null,8,["modelValue"]),d(I,{type:"primary",class:"ml-10 submit-btn",onClick:g},{default:p(()=>[k(x("提交"))]),_:1})]),d(T,{modelValue:m.value,"onUpdate:modelValue":S[2]||(S[2]=v=>m.value=v),width:"70%",center:""},{footer:p(()=>[u("span",We,[d(I,{onClick:S[1]||(S[1]=v=>m.value=!1)},{default:p(()=>[k("取消")]),_:1}),d(I,{type:"primary",onClick:ce},{default:p(()=>[k(" 提交 ")]),_:1})])]),default:p(()=>[u("div",Ze,x(L.value),1)]),_:1},8,["modelValue"])],64)}}});const tt=V(et,[["__scopeId","data-v-40cc8099"]]),ie=e=>(z("data-v-5ee62532"),e=e(),B(),e),ot={class:"login-box"},st=ie(()=>u("div",{class:"login-title"}," ai chat登录 ",-1)),nt=ie(()=>u("div",{class:"login-footer"},null,-1)),lt=J({__name:"Login",emits:["loginSuccess"],setup(e,{emit:t}){const s=j({username:"",password:""}),n=y(),o=j({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),l=async c=>{c&&await c.validate((i,g)=>{if(i&&s.username==="huhaibiao")return a({success:!0,data:{token:1,expiresIn:2e5}})})},a=c=>{let i="登录成功",g,m;c.success?(i="登录成功",g="success",m=1e3,Ne(c.data.token,new Date().getTime()/1e3,c.data.expiresIn),t("loginSuccess")):(i=c.msg,g="error",m=3e3),ee({message:i,type:g,duration:m})};return(c,i)=>{const g=te,m=ve,q=Y,f=ge;return _(),w("div",ot,[st,d(f,{ref_key:"ruleFormRef",ref:n,model:s,rules:o,style:{width:"100%"}},{default:p(()=>[d(m,{prop:"username"},{default:p(()=>[d(g,{modelValue:s.username,"onUpdate:modelValue":i[0]||(i[0]=L=>s.username=L),placeholder:"用户名",class:"div-box"},null,8,["modelValue"])]),_:1}),d(m,{prop:"password"},{default:p(()=>[d(g,{modelValue:s.password,"onUpdate:modelValue":i[1]||(i[1]=L=>s.password=L),type:"password",placeholder:"密码","show-password":"",class:"div-box"},null,8,["modelValue"])]),_:1}),d(q,{type:"primary",class:"div-box",onClick:i[2]||(i[2]=L=>l(n.value))},{default:p(()=>[k("登录")]),_:1})]),_:1},8,["model","rules"]),nt])}}});const at=V(lt,[["__scopeId","data-v-5ee62532"]]);const it=e=>(z("data-v-cc953e34"),e=e(),B(),e),ct={key:0,class:"development"},rt=it(()=>u("div",null,"开发环境",-1)),ut={__name:"Developer",setup(e){const t=y("production");return(s,n)=>t.value==="development"?(_(),w("div",ct,[rt,u("div",null,"ws连接状态："+x(),1),u("div",null,"正在请求中数："+x(A(N)),1)])):O("",!0)}},dt=V(ut,[["__scopeId","data-v-cc953e34"]]),pt=J({__name:"DownLoadChatsList",setup(e){function t(n,o){const l=document.createElement("a"),a=new Blob([o]),c=URL.createObjectURL(a);l.href=c,l.download=n+".json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(c)}const s=n=>{const o=U();t("ai-chat-history",JSON.stringify(o))};return(n,o)=>{const l=Y;return _(),$(l,{type:"primary",plain:"",onClick:s},{default:p(()=>[k("导出所有对话")]),_:1})}}}),_t={key:1},mt=J({__name:"QuestList",emits:["change"],setup(e,{emit:t}){const s=y(U()),n=y(),o=c=>{t("change",c,s.value[c])},l=je(),a=y(l);return(c,i)=>{const g=we,m=Se,q=ye;return _(),$(q,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=f=>n.value=f),placeholder:"打开问题列表",filterable:"",onChange:o,style:{height:"800px"}},{default:p(()=>[(_(!0),w(R,null,W(s.value,(f,L)=>(_(),$(m,{class:"option",key:L,label:f.question,value:L},{default:p(()=>[a.value?(_(),w("div",_t,x(f.question),1)):(_(),$(g,{key:0,class:"box-item",effect:"dark",content:f.question,"hide-after":0,placement:"top"},{default:p(()=>[k(x(f.question),1)]),_:2},1032,["content"]))]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])}}});const ft=V(mt,[["__scopeId","data-v-04451b97"]]),ht={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},gt=u("path",{fill:"currentColor",d:"M926.784 480H701.312A192.512 192.512 0 0 0 544 322.688V97.216A416.064 416.064 0 0 1 926.784 480zm0 64A416.064 416.064 0 0 1 544 926.784V701.312A192.512 192.512 0 0 0 701.312 544h225.472zM97.28 544h225.472A192.512 192.512 0 0 0 480 701.312v225.472A416.064 416.064 0 0 1 97.216 544zm0-64A416.064 416.064 0 0 1 480 97.216v225.472A192.512 192.512 0 0 0 322.688 480H97.216z"},null,-1),vt=[gt];function yt(e,t){return _(),w("svg",ht,vt)}const wt={name:"ep-HelpFilled",render:yt},St={key:0,class:"exp-chat-list"},bt={style:{"white-space":"pre-wrap"}},Lt={key:1,style:{width:"100%",height:"100%"},class:"chat-component"},xt={key:2,class:"login"},It=J({__name:"App",setup(e){let t=y(!0);const s=()=>{t.value=De()};s();const n=y({question:"",rep:""}),o=y(!1),l=(c,i)=>{n.value=i,o.value=!0},a=y(!1);return Z(()=>{Je(document,()=>a.value=!0)}),(c,i)=>{const g=Le,m=xe,q=oe;return _(),w(R,null,[A(t)?O("",!0):(_(),w("div",St,[d(g,{size:30,style:{"margin-top":"10px",cursor:"pointer"},color:"#409EFC",onClick:i[0]||(i[0]=f=>a.value=!a.value)},{default:p(()=>[d(A(wt))]),_:1}),d(m,{modelValue:a.value,"onUpdate:modelValue":i[1]||(i[1]=f=>a.value=f),title:"I am the title","with-header":!1,size:"220"},{default:p(()=>[d(pt),d(ft,{style:{"margin-top":"10px"},onChange:l})]),_:1},8,["modelValue"])])),d(q,{modelValue:o.value,"onUpdate:modelValue":i[2]||(i[2]=f=>o.value=f),title:n.value.question,width:"80%"},{default:p(()=>[u("div",bt,x(n.value.rep),1)]),_:1},8,["modelValue","title"]),d(dt),A(t)?O("",!0):(_(),w("div",Lt,[d(tt,{onJLogin:s})])),A(t)?(_(),w("div",xt,[d(at,{onLoginSuccess:i[3]||(i[3]=f=>be(t)?t.value=!1:t=!1)})])):O("",!0)],64)}}});const Ct=V(It,[["__scopeId","data-v-f163f76e"]]),kt=Ie(Ct);kt.mount("#app");window.hhh_API_key="sk-sXorgfTEXsSjL3dYRyz5T3BlbkFJLPSgoEzrTM9QxZZOvhMAhh";window.__APP_ENV__="production";console.log(window.__APP_ENV__,!1);
