import{d as H,r as F,a as h,c as L,b as _,w as m,E as pe,o as v,e as T,p as z,f as B,g as d,h as me,i as te,j as fe,k as X,t as k,u as I,l as V,m as $,n as oe,F as P,q as ve,s as ge,v as he,x as ye,y as Se,z as be,A as se,B as we,C as Le,D as ne,G as le,H as G,I as Ie,J as ke,K as xe,L as Ee}from"./vendor-fdc8bbe2.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}})();const K=e=>{const t=navigator.userAgent,o=/Chrome/.test(t)&&/Google Inc/.test(navigator.vendor),r=/Firefox/.test(t),s=/Trident/.test(t),n=/Edge/.test(t),l=/Safari/.test(t)&&/Apple Computer/.test(navigator.vendor),i=o*5+r*10+s*10+n*10+l*5||5;let a=1024*1024*i*.9;return new Blob([e]).size>a},Te=(e,t,o)=>{localStorage.setItem("token",e),localStorage.setItem("saveTokenTime",JSON.stringify(t)),localStorage.setItem("expiresIn",JSON.stringify(o))};let M;const ae=()=>{const e="chatsList";return M=localStorage.getItem(e),M===null?[]:JSON.parse(M)},Ce=()=>{if(!localStorage.getItem("token"))return!0;const e=JSON.parse(localStorage.getItem("saveTokenTime")),t=JSON.parse(localStorage.getItem("expiresIn"));return new Date().getTime()/1e3-e>t},qe=(e,t)=>{let o,r;e.addEventListener("touchstart",function(s){o=s.touches[0].clientX,r=s.touches[0].clientY}),e.addEventListener("touchmove",function(s){const n=s.touches[0].clientX-o,l=s.touches[0].clientY-r;Math.abs(n)>Math.abs(l)?n<-80?(console.log("向左滑动"),t()):console.log("向右滑动"):l<0?console.log("向上滑动"):console.log("向下滑动")}),e.addEventListener("touchend",function(s){o=null,r=null})};function Ve(){const e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipod","ipad","windows phone","blackberry","mobile"];for(let o=0;o<t.length;o++)if(e.indexOf(t[o])!==-1)return!0;return!1}const $e=(e,t)=>{e.addEventListener("contextmenu",function(o){console.log("🚀 ~ file: utils.js:165 ~ event:",o.target),console.log(window.getSelection().toString()),t()})},ie=e=>(z("data-v-5ee62532"),e=e(),B(),e),Ne={class:"login-box"},Ae=ie(()=>d("div",{class:"login-title"}," ai chat登录 ",-1)),Oe=ie(()=>d("div",{class:"login-footer"},null,-1)),De=H({__name:"Login",emits:["loginSuccess"],setup(e,{emit:t}){const o=F({username:"",password:""}),r=h(),s=F({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),n=async i=>{i&&await i.validate((a,S)=>{if(a&&o.username==="huhaibiao")return l({success:!0,data:{token:1,expiresIn:2e5}})})},l=i=>{let a="登录成功",S,b;i.success?(a="登录成功",S="success",b=1e3,Te(i.data.token,new Date().getTime()/1e3,i.data.expiresIn),t("loginSuccess")):(a=i.msg,S="error",b=3e3),me({message:a,type:S,duration:b})};return(i,a)=>{const S=te,b=fe,C=X,g=pe;return v(),L("div",Ne,[Ae,_(g,{ref_key:"ruleFormRef",ref:r,model:o,rules:s,style:{width:"100%"}},{default:m(()=>[_(b,{prop:"username"},{default:m(()=>[_(S,{modelValue:o.username,"onUpdate:modelValue":a[0]||(a[0]=x=>o.username=x),placeholder:"用户名",class:"div-box"},null,8,["modelValue"])]),_:1}),_(b,{prop:"password"},{default:m(()=>[_(S,{modelValue:o.password,"onUpdate:modelValue":a[1]||(a[1]=x=>o.password=x),type:"password",placeholder:"密码","show-password":"",class:"div-box"},null,8,["modelValue"])]),_:1}),_(C,{type:"primary",class:"div-box",onClick:a[2]||(a[2]=x=>n(r.value))},{default:m(()=>[T("登录")]),_:1})]),_:1},8,["model","rules"]),Oe])}}});const N=(e,t)=>{const o=e.__vccOpts||e;for(const[r,s]of t)o[r]=s;return o},He=N(De,[["__scopeId","data-v-5ee62532"]]),Je=h(0);const Re=e=>(z("data-v-cc953e34"),e=e(),B(),e),Ue={key:0,class:"development"},Fe=Re(()=>d("div",null,"开发环境",-1)),Pe={__name:"Developer",setup(e){const t=h("production");return(o,r)=>t.value==="development"?(v(),L("div",Ue,[Fe,d("div",null,"ws连接状态："+k(),1),d("div",null,"正在请求中数："+k(I(Je)),1)])):V("",!0)}},ze=N(Pe,[["__scopeId","data-v-cc953e34"]]),Be=H({__name:"DownLoadChatsList",setup(e){function t(r,s){const n=document.createElement("a"),l=new Blob([s]),i=URL.createObjectURL(l);n.href=i,n.download=r+".json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}const o=r=>{const s=ae();t("ai-chat-history",JSON.stringify(s))};return(r,s)=>{const n=X;return v(),$(n,{type:"primary",plain:"",onClick:o},{default:m(()=>[T("导出所有对话")]),_:1})}}}),je={key:1},Me=H({__name:"QuestList",emits:["change"],setup(e,{emit:t}){const o=h(ae()),r=h(),s=i=>{t("change",i,o.value[i])},n=Ve(),l=h(n);return(i,a)=>{const S=ge,b=he,C=ve;return v(),$(C,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=g=>r.value=g),placeholder:"打开问题列表",filterable:"",onChange:s,style:{height:"800px"}},{default:m(()=>[(v(!0),L(P,null,oe(o.value,(g,x)=>(v(),$(b,{class:"option",key:x,label:g.question,value:x},{default:m(()=>[l.value?(v(),L("div",je,k(g.question),1)):(v(),$(S,{key:0,class:"box-item",effect:"dark",content:g.question,"hide-after":0,placement:"top"},{default:m(()=>[T(k(g.question),1)]),_:2},1032,["content"]))]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])}}});const We=N(Me,[["__scopeId","data-v-04451b97"]]),Xe={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Qe=d("path",{fill:"currentColor",d:"M926.784 480H701.312A192.512 192.512 0 0 0 544 322.688V97.216A416.064 416.064 0 0 1 926.784 480zm0 64A416.064 416.064 0 0 1 544 926.784V701.312A192.512 192.512 0 0 0 701.312 544h225.472zM97.28 544h225.472A192.512 192.512 0 0 0 480 701.312v225.472A416.064 416.064 0 0 1 97.216 544zm0-64A416.064 416.064 0 0 1 480 97.216v225.472A192.512 192.512 0 0 0 322.688 480H97.216z"},null,-1),Ye=[Qe];function Ge(e,t){return v(),L("svg",Xe,Ye)}const Ke={name:"ep-HelpFilled",render:Ge};const Ze={},Q=e=>(z("data-v-943f389e"),e=e(),B(),e),et={class:"loading"},tt=Q(()=>d("div",{class:"point an-point"},null,-1)),ot=Q(()=>d("div",{class:"point an-point"},null,-1)),st=Q(()=>d("div",{class:"point an-point"},null,-1)),nt=[tt,ot,st];function lt(e,t){return v(),L("div",et,nt)}const Z=N(Ze,[["render",lt],["__scopeId","data-v-943f389e"]]);let W="ws://18.216.251.165:8088";location!=null&&location.protocol.includes("https")&&(W="wss"+W.slice(2));const D={appId:"G8CPjjcTqnNU4NjC",sessionId:"qbd4r6rahnxuazy5qoqd"},q={mesHandle(e){},closeHandle(e){},openHandle(e){console.log("time:"+new Date().toLocaleTimeString()+"🚀 ~ file: websocketChat.js:20 ~ openHandle ~ event:",e)},errorHandle(e){}};let w={};const re=()=>{let e=`${W}?appId=${D.appId}&sessionId=${D.sessionId}`;const t=localStorage.getItem("token");t&&(e=e+`&token=${t}`),w=new WebSocket(e),w.onclose=q.closeHandle,w.onerror=q.errorHandle,w.onmessage=q.mesHandle,w.onopen=q.openHandle};function at(){}setInterval(at,1e4);const ee=(e="")=>{const t=setInterval(()=>{w.readyState===WebSocket.OPEN&&(clearInterval(t),w.send(e))},200)},it=(e="")=>{if(w.readyState===WebSocket.OPEN)return w.send(e);if(w.readyState!==WebSocket.OPEN){if(w.readyState===WebSocket.CONNECTING)return ee(e),console.warn("正在连接中");re()}ee(e)};const ce=e=>(z("data-v-6da940db"),e=e(),B(),e),rt={class:"chat-list"},ct={class:"chat-item chat-item-user",style:{position:"relative"}},dt={class:"chat-item-rep mr-10 user"},ut=ce(()=>d("div",{class:"me square"},"我",-1)),_t={class:"time",style:{position:"absolute",bottom:"-25px",right:"50px"}},pt={class:"chat-item",style:{position:"relative"}},mt=ce(()=>d("div",{class:"square"},"ai",-1)),ft={class:"chat-item-rep ml-10"},vt={class:"time",style:{position:"absolute",bottom:"-25px",left:"50px"}},gt={class:"submit-bottom"},ht={style:{"word-wrap":"break-word"}},yt={class:"dialog-footer"},St=H({__name:"WsChat",emits:["JLogin"],setup(e,{emit:t}){t("JLogin");let o=-1;const r=c=>{const p=c||"chat-list";return JSON.parse(localStorage.getItem(p))},s=localStorage.getItem("sessionId");s?D.sessionId=s:(D.sessionId=ye(),localStorage.setItem("sessionId",D.sessionId));const n=h("");let l=h(0),i=F([]);i.push(...r("chatsList")),o=i.length-1;const a=h(null),S=h(null);let b=!0;const C=c=>{let p=n.value;c?p=c:o=i.length;const y=F({question:"",questionTime:"",rep:"",repTime:""});if(n.value="",y.question=p,y.questionTime=new Date().toLocaleString(),n.value="",!p.trim())return;l.value=1,i.splice(o,0,y),b=!0;const E=JSON.stringify({req:p,index:o});it(E),o===i.length&&document.querySelector(".chat-item-scrollTo").scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})};Se(()=>{}),be(()=>{w.close()}),se(()=>{var R,U;a.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"});var c=document.querySelectorAll(".submit-bottom");let p=0;document.querySelector(".chat-list").addEventListener("scroll",function(f){f.target.scrollTop<p&&(b=!1),p=f.target.scrollTop,y(f.target)&&f.preventDefault()});function y(f){for(var u=0;u<c.length;u++)if(c[u].contains(f))return!0;return!1}document.addEventListener("touchmove",function(f){if(!y(f.target)){var u=document.activeElement;(u.tagName==="INPUT"||u.tagName==="TEXTAREA")&&u.blur()}});let E=!1;const O=document.querySelector(".chat-input");O.addEventListener("compositionstart",()=>{E=!0}),O.addEventListener("compositionend",f=>{E=!1}),O.addEventListener("keydown",f=>{f.key==="Enter"&&!E&&(f.preventDefault(),C())}),(R=document.querySelector(".chat-list"))==null||R.addEventListener("mousedown",f=>{var u;o=+((u=f.target)==null?void 0:u.getAttribute("class"))}),$e(document.querySelector(".chat-list"),Y),(U=document.querySelector(".chat-list"))==null||U.addEventListener("contextmenu",function(f){var u;o=+((u=f.target)==null?void 0:u.getAttribute("class")),f.preventDefault(),Y()})});const g=()=>{w.close(),l.value=0},x=(c=[])=>{const p=JSON.stringify(c);if(K(p))c.shift(),c.shift(),K(JSON.stringify(c))&&x(c);else return},de=(c=[])=>{x(c);const p="chatsList";try{localStorage.setItem(p,JSON.stringify(c))}catch(y){console.error("本地存储数据时出错：",y)}},ue=(c={content:"",id:0})=>{l.value=2,i[c.id].rep+=c.content,b&&setTimeout(()=>{a.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})})};q.mesHandle=c=>{let p=c.data,y=JSON.parse(p);y.msg==="DONE"&&(l.value=0,i[o].repTime=new Date().toLocaleString(),de(i)),y.time||ue(y)},q.closeHandle=c=>{console.log("WebSocket closed with code "+c.code+" and reason "+c.reason+"time:"+new Date().toLocaleTimeString()),l.value=0,alert("ws链接关闭")},q.errorHandle=()=>{l.value=0},q.openHandle=()=>{l.value=0};const A=h(!1),Y=()=>{J.value=window.getSelection().toString(),J.value&&(A.value=!0)},J=h(""),_e=()=>{C(J.value),A.value=!1};return re(),(c,p)=>{const y=Ie,E=X,O=te,R=Z,U=ne,f=le;return v(),L(P,null,[d("div",rt,[(v(!0),L(P,null,oe(I(i),(u,j)=>(v(),L("div",{key:j},[d("div",ct,[d("div",dt,k(u.question),1),ut,d("div",_t,[_(y,{type:"info",size:"small"},{default:m(()=>[T(k("时间:"+u.questionTime),1)]),_:2},1024)])]),d("div",pt,[mt,d("div",ft,[u.rep?V("",!0):(v(),$(Z,{key:0})),d("span",{class:G(j+1+"")},[T(k(u.rep),1),d("span",{class:G({"rep-light-cursor":j===I(i).length-1&&I(l)===2})},null,2)],2)]),d("div",vt,[_(y,{type:"info",size:"small"},{default:m(()=>[T(k("时间:"+u.repTime),1)]),_:2},1024)])])]))),128)),d("div",{class:"chat-item-scrollTo",ref_key:"scrollToDom",ref:a},null,512)]),d("div",gt,[we(_(E,{type:"danger",round:"",class:"doneRep",onClick:g},{default:m(()=>[T("终止回答")]),_:1},512),[[Le,I(l)!==0]]),_(O,{ref_key:"qInoutEl",ref:S,class:"do-scrollbar-b chat-input",modelValue:n.value,"onUpdate:modelValue":p[0]||(p[0]=u=>n.value=u),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"欢迎提问～"},null,8,["modelValue"]),_(E,{type:"primary",class:"ml-10 submit-btn",onClick:C,disabled:I(l)!==0},{default:m(()=>[T(k(I(l)!==0?"回复中":"提交"),1),I(l)!==0?(v(),$(U,{key:0,class:"is-loading"},{default:m(()=>[_(R)]),_:1})):V("",!0)]),_:1},8,["disabled"])]),_(f,{modelValue:A.value,"onUpdate:modelValue":p[2]||(p[2]=u=>A.value=u),width:"70%",center:""},{footer:m(()=>[d("span",yt,[_(E,{onClick:p[1]||(p[1]=u=>A.value=!1)},{default:m(()=>[T("取消")]),_:1}),_(E,{type:"primary",onClick:_e},{default:m(()=>[T(" 提交 ")]),_:1})])]),default:m(()=>[d("div",ht,k(J.value),1)]),_:1},8,["modelValue"])],64)}}});const bt=N(St,[["__scopeId","data-v-6da940db"]]),wt={key:0,class:"exp-chat-list"},Lt={style:{"white-space":"pre-wrap"}},It={key:1,style:{width:"100%",height:"100%"},class:"chat-component"},kt={key:2,class:"login"},xt=H({__name:"App",setup(e){let t=h(!0);const o=()=>{t.value=Ce()};o();const r=h({question:"",rep:""}),s=h(!1),n=(i,a)=>{r.value=a,s.value=!0},l=h(!1);return se(()=>{qe(document,()=>l.value=!0)}),(i,a)=>{const S=ne,b=xe,C=le;return v(),L(P,null,[I(t)?V("",!0):(v(),L("div",wt,[_(S,{size:30,style:{"margin-top":"10px",cursor:"pointer"},color:"#409EFC",onClick:a[0]||(a[0]=g=>l.value=!l.value)},{default:m(()=>[_(I(Ke))]),_:1}),_(b,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=g=>l.value=g),title:"I am the title","with-header":!1,size:"220"},{default:m(()=>[_(Be),_(We,{style:{"margin-top":"10px"},onChange:n})]),_:1},8,["modelValue"])])),_(C,{modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=g=>s.value=g),title:r.value.question,width:"80%"},{default:m(()=>[d("div",Lt,k(r.value.rep),1)]),_:1},8,["modelValue","title"]),_(ze),I(t)?V("",!0):(v(),L("div",It,[_(bt,{onJLogin:o})])),I(t)?(v(),L("div",kt,[_(He,{onLoginSuccess:a[3]||(a[3]=g=>ke(t)?t.value=!1:t=!1)})])):V("",!0)],64)}}});const Et=N(xt,[["__scopeId","data-v-3e30f885"]]);const Tt=Ee(Et);Tt.mount("#app");window.hhh_API_key="hhsk-sXorgfTEXsSjL3dYRyz5T3BlbkFJLPSgoEzrTM9QxZZOvhMAhh";window.__APP_ENV__="production";console.log(window.__APP_ENV__,!1);
