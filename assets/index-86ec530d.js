import{d as D,r as U,a as b,c as I,b as d,w as p,E as _e,o as g,e as k,p as B,f as M,g as u,h as pe,i as oe,j as me,k as W,l as N,m as se,F,n as fe,t as E,q as ge,s as ve,v as he,u as ye,x as ne,y as T,z as we,A as be,B as $,C as le,D as ae,G as K,H as Se,I as Le,J as Ie,K as ke}from"./vendor-bb3e1138.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const Z=e=>{const t=navigator.userAgent,s=/Chrome/.test(t)&&/Google Inc/.test(navigator.vendor),i=/Firefox/.test(t),o=/Trident/.test(t),n=/Edge/.test(t),l=/Safari/.test(t)&&/Apple Computer/.test(navigator.vendor),c=s*5+i*10+o*10+n*10+l*5||5;let a=1024*1024*c*.9;return new Blob([e]).size>a},xe=(e,t,s)=>{localStorage.setItem("token",e),localStorage.setItem("saveTokenTime",JSON.stringify(t)),localStorage.setItem("expiresIn",JSON.stringify(s))};let z;const X=()=>{const e="chatsList";return z=localStorage.getItem(e),z===null?[]:JSON.parse(z)},Ee=()=>{if(!localStorage.getItem("token"))return!0;const e=JSON.parse(localStorage.getItem("saveTokenTime")),t=JSON.parse(localStorage.getItem("expiresIn"));return new Date().getTime()/1e3-e>t},Te=(e,t)=>{let s,i;e.addEventListener("touchstart",function(o){s=o.touches[0].clientX,i=o.touches[0].clientY}),e.addEventListener("touchmove",function(o){const n=o.touches[0].clientX-s,l=o.touches[0].clientY-i;Math.abs(n)>Math.abs(l)?n<-80?(console.log("向左滑动"),t()):console.log("向右滑动"):l<0?console.log("向上滑动"):console.log("向下滑动")}),e.addEventListener("touchend",function(o){s=null,i=null})};function Ve(){const e=navigator.userAgent.toLowerCase(),t=["android","iphone","ipod","ipad","windows phone","blackberry","mobile"];for(let s=0;s<t.length;s++)if(e.indexOf(t[s])!==-1)return!0;return!1}const qe=(e,t)=>{e.addEventListener("contextmenu",function(s){console.log("🚀 ~ file: utils.js:165 ~ event:",s.target),console.log(window.getSelection().toString()),t()})},ie=e=>(B("data-v-8ee76217"),e=e(),M(),e),Ce={class:"login-box"},Ne=ie(()=>u("div",{class:"login-title"},"ai chat登录",-1)),Ae=ie(()=>u("div",{class:"login-footer"},null,-1)),$e=D({__name:"Login",emits:["loginSuccess"],setup(e,{emit:t}){const s=U({username:"",password:""}),i=b(),o=U({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),n=async c=>{c&&await c.validate((a,y)=>{if(a)return s.username==="huhaibiao"&&s.password==="1"?l({success:!0,data:{token:1,expiresIn:2e5}}):l({success:!1,msg:"登陆失败",data:{token:1,expiresIn:2e5}})})},l=c=>{let a="登录成功",y,w;c.success?(a="登录成功",y="success",w=1e3,xe(c.data.token,new Date().getTime()/1e3,c.data.expiresIn),t("loginSuccess")):(a=c.msg,y="error",w=3e3),pe({message:a,type:y,duration:w})};return(c,a)=>{const y=oe,w=me,q=W,v=_e;return g(),I("div",Ce,[Ne,d(v,{ref_key:"ruleFormRef",ref:i,model:s,rules:o,style:{width:"100%"}},{default:p(()=>[d(w,{prop:"username"},{default:p(()=>[d(y,{modelValue:s.username,"onUpdate:modelValue":a[0]||(a[0]=x=>s.username=x),placeholder:"用户名",class:"div-box"},null,8,["modelValue"])]),_:1}),d(w,{prop:"password"},{default:p(()=>[d(y,{modelValue:s.password,"onUpdate:modelValue":a[1]||(a[1]=x=>s.password=x),type:"password",placeholder:"密码","show-password":"",class:"div-box"},null,8,["modelValue"])]),_:1}),d(q,{type:"primary",class:"div-box",onClick:a[2]||(a[2]=x=>n(i.value))},{default:p(()=>[k("登录")]),_:1})]),_:1},8,["model","rules"]),Ae])}}});const H=(e,t)=>{const s=e.__vccOpts||e;for(const[i,o]of t)s[i]=o;return s},Oe=H($e,[["__scopeId","data-v-8ee76217"]]),De=D({__name:"DownLoadChatsList",setup(e){function t(i,o){const n=document.createElement("a"),l=new Blob([o]),c=URL.createObjectURL(l);n.href=c,n.download=i+".json",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(c)}const s=i=>{const o=X();t("ai-chat-history",JSON.stringify(o))};return(i,o)=>{const n=W;return g(),N(n,{type:"primary",plain:"",onClick:s},{default:p(()=>[k("导出所有对话")]),_:1})}}}),He={key:1},Je=D({__name:"QuestList",emits:["change"],setup(e,{emit:t}){const s=b(X()),i=b(),o=c=>{t("change",c,s.value[c])},n=Ve(),l=b(n);return(c,a)=>{const y=ge,w=ve,q=fe;return g(),N(q,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=v=>i.value=v),placeholder:"打开问题列表",filterable:"",onChange:o,style:{height:"800px"}},{default:p(()=>[(g(!0),I(F,null,se(s.value,(v,x)=>(g(),N(w,{class:"option",key:x,label:v.question,value:x},{default:p(()=>[l.value?(g(),I("div",He,E(v.question),1)):(g(),N(y,{key:0,class:"box-item",effect:"dark",content:v.question,"hide-after":0,placement:"top"},{default:p(()=>[k(E(v.question),1)]),_:2},1032,["content"]))]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])}}});const Pe=H(Je,[["__scopeId","data-v-04451b97"]]),Re={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Ue=u("path",{fill:"currentColor",d:"M926.784 480H701.312A192.512 192.512 0 0 0 544 322.688V97.216A416.064 416.064 0 0 1 926.784 480zm0 64A416.064 416.064 0 0 1 544 926.784V701.312A192.512 192.512 0 0 0 701.312 544h225.472zM97.28 544h225.472A192.512 192.512 0 0 0 480 701.312v225.472A416.064 416.064 0 0 1 97.216 544zm0-64A416.064 416.064 0 0 1 480 97.216v225.472A192.512 192.512 0 0 0 322.688 480H97.216z"},null,-1),Fe=[Ue];function ze(e,t){return g(),I("svg",Re,Fe)}const je={name:"ep-HelpFilled",render:ze};const Be={},Q=e=>(B("data-v-943f389e"),e=e(),M(),e),Me={class:"loading"},We=Q(()=>u("div",{class:"point an-point"},null,-1)),Xe=Q(()=>u("div",{class:"point an-point"},null,-1)),Qe=Q(()=>u("div",{class:"point an-point"},null,-1)),Ye=[We,Xe,Qe];function Ge(e,t){return g(),I("div",Me,Ye)}const ee=H(Be,[["render",Ge],["__scopeId","data-v-943f389e"]]);let j="ws://18.216.251.165:8088";location!=null&&location.protocol.includes("https")&&(j="wss"+j.slice(2));const O={appId:"G8CPjjcTqnNU4NjC",sessionId:"qbd4r6rahnxuazy5qoqd"},V={mesHandle(e){},closeHandle(e){},openHandle(e){console.log("time:"+new Date().toLocaleTimeString()+"🚀 ~ file: websocketChat.js:20 ~ openHandle ~ event:",e)},errorHandle(e){}};let S={};const re=()=>{let e=`${j}?appId=${O.appId}&sessionId=${O.sessionId}`;const t=localStorage.getItem("token");t&&(e=e+`&token=${t}`),S=new WebSocket(e),S.onclose=V.closeHandle,S.onerror=V.errorHandle,S.onmessage=V.mesHandle,S.onopen=V.openHandle};function Ke(){}setInterval(Ke,1e4);const te=(e="")=>{const t=setInterval(()=>{S.readyState===WebSocket.OPEN&&(clearInterval(t),S.send(e))},200)},Ze=(e="")=>{if(S.readyState===WebSocket.OPEN)return S.send(e);if(S.readyState!==WebSocket.OPEN){if(S.readyState===WebSocket.CONNECTING)return te(e),console.warn("正在连接中");re()}te(e)};const ce=e=>(B("data-v-889d99e4"),e=e(),M(),e),et={class:"chat-list"},tt={class:"chat-item chat-item-user",style:{position:"relative"}},ot={class:"chat-item-rep mr-10 user"},st=ce(()=>u("div",{class:"me square"},"我",-1)),nt={class:"time",style:{position:"absolute",bottom:"-25px",right:"50px"}},lt={class:"chat-item",style:{position:"relative"}},at=ce(()=>u("div",{class:"square"},"ai",-1)),it={class:"chat-item-rep ml-10"},rt={class:"time",style:{position:"absolute",bottom:"-25px",left:"50px"}},ct={class:"submit-bottom"},dt={style:{"word-wrap":"break-word"}},ut={class:"dialog-footer"},_t=D({__name:"WsChat",emits:["JLogin"],setup(e,{emit:t}){t("JLogin");let s=-1;const i=localStorage.getItem("sessionId");i?O.sessionId=i:(O.sessionId=he(),localStorage.setItem("sessionId",O.sessionId));const o=b("");let n=b(0),l=U([]);l.push(...X()),s=l.length-1;const c=b(null),a=b(null);let y=!0;const w=(_,f)=>{let h=o.value;f?h=f:s=l.length;const L=U({question:"",questionTime:"",rep:"",repTime:""});if(o.value="",L.question=h,L.questionTime=new Date().toLocaleString(),o.value="",!h.trim())return;l.splice(s,0,L),y=!0;const C=JSON.stringify({req:h,index:s});Ze(C),s===l.length-1&&setTimeout(()=>{document.querySelector(".chat-item-scrollTo").scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})})};ye(()=>{S.close()}),ne(()=>{var P,R;c.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"});var _=document.querySelectorAll(".submit-bottom");let f=0;document.querySelector(".chat-list").addEventListener("scroll",function(m){m.target.scrollTop<f&&(y=!1),f=m.target.scrollTop,h(m.target)&&m.preventDefault()});function h(m){for(var r=0;r<_.length;r++)if(_[r].contains(m))return!0;return!1}document.addEventListener("touchmove",function(m){if(!h(m.target)){var r=document.activeElement;(r.tagName==="INPUT"||r.tagName==="TEXTAREA")&&r.blur()}});let L=!1;const C=document.querySelector(".chat-input");C.addEventListener("compositionstart",()=>{L=!0}),C.addEventListener("compositionend",m=>{L=!1}),C.addEventListener("keydown",m=>{m.key==="Enter"&&!L&&(m.preventDefault(),w())}),(P=document.querySelector(".chat-list"))==null||P.addEventListener("mousedown",m=>{var r;s=+((r=m.target)==null?void 0:r.getAttribute("class"))}),qe(document.querySelector(".chat-list"),Y),(R=document.querySelector(".chat-list"))==null||R.addEventListener("contextmenu",function(m){var r;s=+((r=m.target)==null?void 0:r.getAttribute("class")),m.preventDefault(),Y()})});const q=()=>{S.close(),n.value=0},v=(_=[])=>{const f=JSON.stringify(_);if(Z(f))_.shift(),_.shift(),Z(JSON.stringify(_))&&v(_);else return},x=(_=[])=>{v(_);const f="chatsList";try{localStorage.setItem(f,JSON.stringify(_))}catch(h){console.error("本地存储数据时出错：",h)}},de=(_={content:"",id:0})=>{n.value=2,l[_.id].rep+=_.content,y&&setTimeout(()=>{c.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})})};V.mesHandle=_=>{let f=_.data,h=JSON.parse(f);h.msg==="DONE"&&(n.value=0,l[h.id].repTime=new Date().toLocaleString(),x(l)),h.time||de(h)},V.closeHandle=_=>{console.log("WebSocket closed with code "+_.code+" and reason "+_.reason+"time:"+new Date().toLocaleTimeString()),n.value=0,window.__APP_ENV__!=="development"&&alert("ws链接关闭")},V.errorHandle=()=>{n.value=0},V.openHandle=()=>{n.value=0};const A=b(!1),Y=()=>{J.value=window.getSelection().toString(),J.value&&(A.value=!0)},J=b(""),ue=()=>{w(null,J.value),A.value=!1};return re(),(_,f)=>{const h=Se,L=W,C=oe,P=ee,R=le,m=ae;return g(),I(F,null,[u("div",et,[(g(!0),I(F,null,se(T(l),(r,G)=>(g(),I("div",{key:G},[u("div",tt,[u("div",ot,E(r.question),1),st,u("div",nt,[d(h,{type:"info",size:"small"},{default:p(()=>[k(E("时间:"+r.questionTime),1)]),_:2},1024)])]),u("div",lt,[at,u("div",it,[r.rep?$("",!0):(g(),N(ee,{key:0})),u("span",{class:K(G+1+"")},[k(E(r.rep),1),u("span",{class:K({"rep-light-cursor":r.rep&&!r.repTime})},null,2)],2)]),u("div",rt,[d(h,{type:"info",size:"small"},{default:p(()=>[k(E("时间:"+r.repTime),1)]),_:2},1024)])])]))),128)),u("div",{class:"chat-item-scrollTo",ref_key:"scrollToDom",ref:c},null,512)]),u("div",ct,[we(d(L,{type:"danger",round:"",class:"doneRep",onClick:q},{default:p(()=>[k("终止回答")]),_:1},512),[[be,T(n)!==0]]),d(C,{ref_key:"qInoutEl",ref:a,class:"do-scrollbar-b chat-input",modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=r=>o.value=r),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"欢迎提问～"},null,8,["modelValue"]),d(L,{type:"primary",class:"ml-10 submit-btn",onClick:w,disabled:T(n)!==0},{default:p(()=>[k(E(T(n)!==0?"回复中":"提交"),1),T(n)!==0?(g(),N(R,{key:0,class:"is-loading"},{default:p(()=>[d(P)]),_:1})):$("",!0)]),_:1},8,["disabled"])]),d(m,{modelValue:A.value,"onUpdate:modelValue":f[2]||(f[2]=r=>A.value=r),width:"70%",center:""},{footer:p(()=>[u("span",ut,[d(L,{onClick:f[1]||(f[1]=r=>A.value=!1)},{default:p(()=>[k("取消")]),_:1}),d(L,{type:"primary",onClick:ue},{default:p(()=>[k(" 提交 ")]),_:1})])]),default:p(()=>[u("div",dt,E(J.value),1)]),_:1},8,["modelValue"])],64)}}});const pt=H(_t,[["__scopeId","data-v-889d99e4"]]),mt={key:0,class:"exp-chat-list"},ft={style:{"white-space":"pre-wrap"}},gt={key:1,style:{width:"100%",height:"100%"},class:"chat-component"},vt={key:2,class:"login"},ht=D({__name:"App",setup(e){let t=b(!0);const s=()=>{t.value=Ee()};s();const i=b({question:"",rep:""}),o=b(!1),n=(c,a)=>{i.value=a,o.value=!0},l=b(!1);return ne(()=>{Te(document,()=>l.value=!0)}),(c,a)=>{const y=le,w=Ie,q=ae;return g(),I(F,null,[T(t)?$("",!0):(g(),I("div",mt,[d(y,{size:30,style:{"margin-top":"10px",cursor:"pointer"},color:"#409EFC",onClick:a[0]||(a[0]=v=>l.value=!l.value)},{default:p(()=>[d(T(je))]),_:1}),d(w,{modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=v=>l.value=v),title:"I am the title","with-header":!1,size:"220"},{default:p(()=>[d(De),d(Pe,{style:{"margin-top":"10px"},onChange:n})]),_:1},8,["modelValue"])])),d(q,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=v=>o.value=v),title:i.value.question,width:"80%"},{default:p(()=>[u("div",ft,E(i.value.rep),1)]),_:1},8,["modelValue","title"]),T(t)?$("",!0):(g(),I("div",gt,[d(pt,{onJLogin:s})])),T(t)?(g(),I("div",vt,[d(Oe,{onLoginSuccess:a[3]||(a[3]=v=>Le(t)?t.value=!1:t=!1)})])):$("",!0)],64)}}});const yt=H(ht,[["__scopeId","data-v-038022b4"]]);const wt=ke(yt);wt.mount("#app");window.hhh_API_key="hhsk-sXorgfTEXsSjL3dYRyz5T3BlbkFJLPSgoEzrTM9QxZZOvhMAhh";window.__APP_ENV__="production";console.log(window.__APP_ENV__,!1);
