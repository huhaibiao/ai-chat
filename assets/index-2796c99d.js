import{d as J,r as j,a as v,c as g,b as d,w as S,E as le,o as u,e as N,p as R,f as F,g as _,h as ae,i as G,j as re,k as B,t as $,u as y,l as T,m as V,n as K,F as C,q as ce,s as ie,v as ue,x as de,y as _e,z as pe,A as Z,B as me,C as ve,D as ee,G as W,H as fe,I as ge,J as he,K as ye}from"./vendor-027c8ae0.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();const X=e=>{const o=navigator.userAgent,n=/Chrome/.test(o)&&/Google Inc/.test(navigator.vendor),a=/Firefox/.test(o),t=/Trident/.test(o),s=/Edge/.test(o),c=/Safari/.test(o)&&/Apple Computer/.test(navigator.vendor),i=n*5+a*10+t*10+s*10+c*5||5;let l=1024*1024*i*.9;return new Blob([e]).size>l},Se=(e,o,n)=>{localStorage.setItem("token",e),localStorage.setItem("saveTokenTime",JSON.stringify(o)),localStorage.setItem("expiresIn",JSON.stringify(n))};let P;const te=()=>{const e="chatsList";return P=localStorage.getItem(e),P===null?[]:JSON.parse(P)},be=()=>{if(!localStorage.getItem("token"))return!0;const e=JSON.parse(localStorage.getItem("saveTokenTime")),o=JSON.parse(localStorage.getItem("expiresIn"));return new Date().getTime()/1e3-e>o},we=(e,o)=>{let n,a;e.addEventListener("touchstart",function(t){n=t.touches[0].clientX,a=t.touches[0].clientY}),e.addEventListener("touchmove",function(t){const s=t.touches[0].clientX-n,c=t.touches[0].clientY-a;Math.abs(s)>Math.abs(c)?s<-80?(console.log("向左滑动"),o()):console.log("向右滑动"):c<0?console.log("向上滑动"):console.log("向下滑动")}),e.addEventListener("touchend",function(t){n=null,a=null})};function Ie(){const e=navigator.userAgent.toLowerCase(),o=["android","iphone","ipod","ipad","windows phone","blackberry","mobile"];for(let n=0;n<o.length;n++)if(e.indexOf(o[n])!==-1)return!0;return!1}const oe=e=>(R("data-v-5ee62532"),e=e(),F(),e),Le={class:"login-box"},ke=oe(()=>_("div",{class:"login-title"}," ai chat登录 ",-1)),Ee=oe(()=>_("div",{class:"login-footer"},null,-1)),xe=J({__name:"Login",emits:["loginSuccess"],setup(e,{emit:o}){const n=j({username:"",password:""}),a=v(),t=j({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),s=async i=>{i&&await i.validate((l,f)=>{if(l&&n.username==="huhaibiao")return c({success:!0,data:{token:1,expiresIn:2e5}})})},c=i=>{let l="登录成功",f,w;i.success?(l="登录成功",f="success",w=1e3,Se(i.data.token,new Date().getTime()/1e3,i.data.expiresIn),o("loginSuccess")):(l=i.msg,f="error",w=3e3),ae({message:l,type:f,duration:w})};return(i,l)=>{const f=G,w=re,E=B,p=le;return u(),g("div",Le,[ke,d(p,{ref_key:"ruleFormRef",ref:a,model:n,rules:t,style:{width:"100%"}},{default:S(()=>[d(w,{prop:"username"},{default:S(()=>[d(f,{modelValue:n.username,"onUpdate:modelValue":l[0]||(l[0]=k=>n.username=k),placeholder:"用户名",class:"div-box"},null,8,["modelValue"])]),_:1}),d(w,{prop:"password"},{default:S(()=>[d(f,{modelValue:n.password,"onUpdate:modelValue":l[1]||(l[1]=k=>n.password=k),type:"password",placeholder:"密码","show-password":"",class:"div-box"},null,8,["modelValue"])]),_:1}),d(E,{type:"primary",class:"div-box",onClick:l[2]||(l[2]=k=>s(a.value))},{default:S(()=>[N("登录")]),_:1})]),_:1},8,["model","rules"]),Ee])}}});const A=(e,o)=>{const n=e.__vccOpts||e;for(const[a,t]of o)n[a]=t;return n},$e=A(xe,[["__scopeId","data-v-5ee62532"]]),Ce=v(0);const Ne=e=>(R("data-v-cc953e34"),e=e(),F(),e),Te={key:0,class:"development"},Ve=Ne(()=>_("div",null,"开发环境",-1)),Ae={__name:"Developer",setup(e){const o=v("production");return(n,a)=>o.value==="development"?(u(),g("div",Te,[Ve,_("div",null,"ws连接状态："+$(),1),_("div",null,"正在请求中数："+$(y(Ce)),1)])):T("",!0)}},Oe=A(Ae,[["__scopeId","data-v-cc953e34"]]),qe=J({__name:"DownLoadChatsList",setup(e){function o(a,t){const s=document.createElement("a"),c=new Blob([t]),i=URL.createObjectURL(c);s.href=i,s.download=a+".json",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}const n=a=>{const t=te();o("ai-chat-history",JSON.stringify(t))};return(a,t)=>{const s=B;return u(),V(s,{type:"primary",plain:"",onClick:n},{default:S(()=>[N("导出所有对话")]),_:1})}}}),He={key:1},De=J({__name:"QuestList",emits:["change"],setup(e,{emit:o}){const n=v(te()),a=v(),t=i=>{o("change",i,n.value[i])},s=Ie(),c=v(s);return(i,l)=>{const f=ie,w=ue,E=ce;return u(),V(E,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=p=>a.value=p),placeholder:"打开问题列表",filterable:"",onChange:t,style:{height:"800px"}},{default:S(()=>[(u(!0),g(C,null,K(n.value,(p,k)=>(u(),V(w,{class:"option",key:k,label:p.question,value:k},{default:S(()=>[c.value?(u(),g("div",He,$(p.question),1)):(u(),V(f,{key:0,class:"box-item",effect:"dark",content:p.question,"hide-after":0,placement:"top"},{default:S(()=>[N($(p.question),1)]),_:2},1032,["content"]))]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])}}});const Je=A(De,[["__scopeId","data-v-04451b97"]]),Re={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Fe=_("path",{fill:"currentColor",d:"M926.784 480H701.312A192.512 192.512 0 0 0 544 322.688V97.216A416.064 416.064 0 0 1 926.784 480zm0 64A416.064 416.064 0 0 1 544 926.784V701.312A192.512 192.512 0 0 0 701.312 544h225.472zM97.28 544h225.472A192.512 192.512 0 0 0 480 701.312v225.472A416.064 416.064 0 0 1 97.216 544zm0-64A416.064 416.064 0 0 1 480 97.216v225.472A192.512 192.512 0 0 0 322.688 480H97.216z"},null,-1),Pe=[Fe];function Ue(e,o){return u(),g("svg",Re,Pe)}const Be={name:"ep-HelpFilled",render:Ue};const ze={},z=e=>(R("data-v-943f389e"),e=e(),F(),e),Me={class:"loading"},je=z(()=>_("div",{class:"point an-point"},null,-1)),We=z(()=>_("div",{class:"point an-point"},null,-1)),Xe=z(()=>_("div",{class:"point an-point"},null,-1)),Qe=[je,We,Xe];function Ye(e,o){return u(),g("div",Me,Qe)}const Q=A(ze,[["render",Ye],["__scopeId","data-v-943f389e"]]);let U="ws://18.216.251.165:8088";location!=null&&location.protocol.includes("https")&&(U="wss"+U.slice(2));const D={appId:"G8CPjjcTqnNU4NjC",sessionId:"qbd4r6rahnxuazy5qoqd"},x={mesHandle(e){},closeHandle(e){},openHandle(e){console.log("time:"+new Date().toLocaleTimeString()+"🚀 ~ file: websocketChat.js:20 ~ openHandle ~ event:",e)},errorHandle(e){}};let b={};const se=()=>{let e=`${U}?appId=${D.appId}&sessionId=${D.sessionId}`;const o=localStorage.getItem("token");o&&(e=e+`&token=${o}`),b=new WebSocket(e),b.onclose=x.closeHandle,b.onerror=x.errorHandle,b.onmessage=x.mesHandle,b.onopen=x.openHandle};function Ge(){}setInterval(Ge,1e4);const Y=(e="")=>{const o=setInterval(()=>{b.readyState===WebSocket.OPEN&&(clearInterval(o),b.send(e))},200)},Ke=(e="")=>{if(b.readyState===WebSocket.OPEN)return b.send(e);if(b.readyState!==WebSocket.OPEN){if(b.readyState===WebSocket.CONNECTING)return Y(e),console.warn("正在连接中");se()}Y(e)},ne=e=>(R("data-v-0a8c5971"),e=e(),F(),e),Ze={class:"chat-list"},et={class:"chat-item-rep mr-10 user"},tt=ne(()=>_("div",{class:"me square"},"我",-1)),ot=ne(()=>_("div",{class:"square"},"ai",-1)),st={class:"chat-item-rep ml-10"},nt={class:"submit-bottom"},lt=J({__name:"WsChat",emits:["JLogin"],setup(e,{emit:o}){o("JLogin");const n=localStorage.getItem("sessionId");n?D.sessionId=n:(D.sessionId=de(),localStorage.setItem("sessionId",D.sessionId));const a=v("");let t=v(0),s=v([]);const c=v(null),i=v(null);let l=!0;const f=()=>{if(t.value!==0)return;let r="",m=a.value;a.value="",m.trim()&&(t.value=1,s.value=[...s.value,m,r],l=!0,Ke(m),setTimeout(()=>{document.querySelector(".chat-item-scrollTo").scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})}))};_e(()=>{const r=k();r?s.value=r:(s=null,s=v([]))}),pe(()=>{b.close()}),Z(()=>{c.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"});var r=document.querySelectorAll(".submit-bottom");let m=0;document.querySelector(".chat-list").addEventListener("scroll",function(h){h.target.scrollTop<m&&(l=!1),m=h.target.scrollTop,I(h.target)&&h.preventDefault()});function I(h){for(var L=0;L<r.length;L++)if(r[L].contains(h))return!0;return!1}document.addEventListener("touchmove",function(h){if(!I(h.target)){var L=document.activeElement;(L.tagName==="INPUT"||L.tagName==="TEXTAREA")&&L.blur()}});let O=!1;const q=document.querySelector(".chat-input");q.addEventListener("compositionstart",()=>{O=!0}),q.addEventListener("compositionend",h=>{O=!1}),q.addEventListener("keydown",h=>{h.key==="Enter"&&!O&&(h.preventDefault(),f())})});const w=()=>{b.close(),t.value=0},E=(r=[])=>{const m=JSON.stringify(r);if(X(m))r.shift(),r.shift(),X(JSON.stringify(r))&&E(r);else return},p=(r=[])=>{E(r);const m="chat-list";try{localStorage.setItem(m,JSON.stringify(r))}catch(I){console.error("本地存储数据时出错：",I)}},k=()=>{const r="chat-list";return JSON.parse(localStorage.getItem(r))},M=(r="")=>{t.value=2,s.value[s.value.length-1]+=r,l&&setTimeout(()=>{c.value.scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})})};return x.mesHandle=r=>{let m=r.data;try{let I=JSON.parse(m);I.msg==="DONE"&&(t.value=0,p(s.value)),I.time||M(I)}catch{M(m)}},x.closeHandle=r=>{console.log("WebSocket closed with code "+r.code+" and reason "+r.reason+"time:"+new Date().toLocaleTimeString()),t.value=0,alert("ws链接关闭")},x.errorHandle=()=>{t.value=0,alert("ws链接发生错误")},x.openHandle=()=>{t.value=0},se(),(r,m)=>{const I=B,O=G,q=Q,h=ee;return u(),g(C,null,[_("div",Ze,[(u(!0),g(C,null,K(y(s),(L,H)=>(u(),g("div",{class:W(["chat-item",{"chat-item-user":H%2===0}]),key:H},[H%2===0?(u(),g(C,{key:0},[_("div",et,$(L),1),tt],64)):(u(),g(C,{key:1},[ot,_("div",st,[H===y(s).length-1&&y(t)===1?(u(),V(Q,{key:0})):T("",!0),_("span",null,[N($(L),1),_("span",{class:W({"rep-light-cursor":H===y(s).length-1&&y(t)===2})},null,2)])])],64))],2))),128)),_("div",{class:"chat-item-scrollTo",ref_key:"scrollToDom",ref:c},null,512)]),_("div",nt,[me(d(I,{type:"danger",round:"",class:"doneRep",onClick:w},{default:S(()=>[N("终止回答")]),_:1},512),[[ve,y(t)!==0]]),d(O,{ref_key:"qInoutEl",ref:i,class:"do-scrollbar-b chat-input",modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=L=>a.value=L),autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"欢迎提问～"},null,8,["modelValue"]),d(I,{type:"primary",class:"ml-10 submit-btn",onClick:f,disabled:y(t)!==0},{default:S(()=>[N($(y(t)!==0?"回复中":"提交"),1),y(t)!==0?(u(),V(h,{key:0,class:"is-loading"},{default:S(()=>[d(q)]),_:1})):T("",!0)]),_:1},8,["disabled"])])],64)}}});const at=A(lt,[["__scopeId","data-v-0a8c5971"]]),rt={key:0,class:"exp-chat-list"},ct={style:{"white-space":"pre-wrap"}},it={key:1,style:{width:"100%",height:"100%"},class:"chat-component"},ut={key:2,class:"login"},dt=J({__name:"App",setup(e){let o=v(!0);const n=()=>{o.value=be()};n();const a=v({question:"",rep:""}),t=v(!1),s=(i,l)=>{a.value=l,t.value=!0},c=v(!1);return Z(()=>{we(document,()=>c.value=!0)}),(i,l)=>{const f=ee,w=ge,E=he;return u(),g(C,null,[y(o)?T("",!0):(u(),g("div",rt,[d(f,{size:30,style:{"margin-top":"10px",cursor:"pointer"},color:"#409EFC",onClick:l[0]||(l[0]=p=>c.value=!c.value)},{default:S(()=>[d(y(Be))]),_:1}),d(w,{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=p=>c.value=p),title:"I am the title","with-header":!1,size:"220"},{default:S(()=>[d(qe),d(Je,{style:{"margin-top":"10px"},onChange:s})]),_:1},8,["modelValue"])])),d(E,{modelValue:t.value,"onUpdate:modelValue":l[2]||(l[2]=p=>t.value=p),title:a.value.question,width:"80%"},{default:S(()=>[_("div",ct,$(a.value.rep),1)]),_:1},8,["modelValue","title"]),d(Oe),y(o)?T("",!0):(u(),g("div",it,[d(at,{onJLogin:n})])),y(o)?(u(),g("div",ut,[d($e,{onLoginSuccess:l[3]||(l[3]=p=>fe(o)?o.value=!1:o=!1)})])):T("",!0)],64)}}});const _t=A(dt,[["__scopeId","data-v-931ab9f2"]]),pt=ye(_t);pt.mount("#app");window.hhh_API_key="hhsk-sXorgfTEXsSjL3dYRyz5T3BlbkFJLPSgoEzrTM9QxZZOvhMAhh";window.__APP_ENV__="production";console.log(window.__APP_ENV__,!1);
